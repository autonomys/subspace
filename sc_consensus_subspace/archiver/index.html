<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Consensus archiver responsible for archival of blockchain history, it is driven by block import pipeline."><title>sc_consensus_subspace::archiver - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-84e720fa.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="sc_consensus_subspace" data-themes="" data-resource-suffix="" data-rustdoc-version="1.89.0-nightly (70b3f4666 2025-05-30)" data-channel="nightly" data-search-js="search-f7877310.js" data-settings-js="settings-5514c975.js" ><script src="../../static.files/storage-4e99c027.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-fd3af306.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-32bb7600.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../sc_consensus_subspace/index.html">sc_<wbr>consensus_<wbr>subspace</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module archiver</a></h2><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate sc_<wbr>consensus_<wbr>subspace</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../index.html">sc_consensus_subspace</a></div><h1>Module <span>archiver</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/sc_consensus_subspace/archiver.rs.html#1-1278">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Consensus archiver responsible for archival of blockchain history, it is driven by block import
pipeline.</p>
<p>Implements archiving process in Subspace blockchain that converts blockchain history (blocks)
into archived history (pieces).</p>
<p>The main entry point here is <a href="fn.create_subspace_archiver.html" title="fn sc_consensus_subspace::archiver::create_subspace_archiver"><code>create_subspace_archiver</code></a> that will create a task, which while
driven will perform the archiving itself.</p>
<p>Archiving is triggered by block importing notification (<a href="../struct.SubspaceLink.html#method.block_importing_notification_stream" title="method sc_consensus_subspace::SubspaceLink::block_importing_notification_stream"><code>SubspaceLink::block_importing_notification_stream</code></a>)
and tries to archive the block at <a href="sp_consensus_subspace::ChainConstants::confirmation_depth_k"><code>ChainConstants::confirmation_depth_k</code></a>
depth from the block being imported. Block import will then wait for archiver to acknowledge
processing, which is necessary for ensuring that when the next block is imported, inherents will
contain segment header of newly archived block (must happen exactly in the next block).</p>
<p>Archiving itself will also wait for acknowledgement by various subscribers before proceeding,
which includes farmer subscription, in case of reference implementation via RPC
(<code>sc-consensus-subspace-rpc</code>), but could also be in other ways.</p>
<p><a href="struct.SegmentHeadersStore.html" title="struct sc_consensus_subspace::archiver::SegmentHeadersStore"><code>SegmentHeadersStore</code></a> is maintained as a data structure containing all known (including future
in case of syncing) segment headers. This data structure contents is then made available to
other parts of the protocol that need to know what correct archival history of the blockchain
looks like. For example, it is used during node sync and farmer plotting in order to verify
pieces of archival history received from other network participants.</p>
<p><a href="fn.recreate_genesis_segment.html" title="fn sc_consensus_subspace::archiver::recreate_genesis_segment"><code>recreate_genesis_segment</code></a> is a bit of a hack and is useful for deriving of the genesis
segment that is special case since we don’t have enough data in the blockchain history itself
during genesis in order to do the archiving.</p>
<p><a href="fn.encode_block.html" title="fn sc_consensus_subspace::archiver::encode_block"><code>encode_block</code></a> and <a href="fn.decode_block.html" title="fn sc_consensus_subspace::archiver::decode_block"><code>decode_block</code></a> are symmetric encoding/decoding functions turning
[<code>SignedBlock</code>]s into bytes and back.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><dl class="item-table"><dt><a class="struct" href="struct.ArchivedSegmentNotification.html" title="struct sc_consensus_subspace::archiver::ArchivedSegmentNotification">Archived<wbr>Segment<wbr>Notification</a></dt><dd>Notification with block header hash that needs to be signed and sender for signature.</dd><dt><a class="struct" href="struct.ObjectMappingNotification.html" title="struct sc_consensus_subspace::archiver::ObjectMappingNotification">Object<wbr>Mapping<wbr>Notification</a></dt><dd>Notification with incrementally generated object mappings for a block (and any previous block
continuation)</dd><dt><a class="struct" href="struct.SegmentHeadersStore.html" title="struct sc_consensus_subspace::archiver::SegmentHeadersStore">Segment<wbr>Headers<wbr>Store</a></dt><dd>Persistent storage of segment headers.</dd></dl><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><dl class="item-table"><dt><a class="enum" href="enum.CreateObjectMappings.html" title="enum sc_consensus_subspace::archiver::CreateObjectMappings">Create<wbr>Object<wbr>Mappings</a></dt><dd>Whether to create object mappings.</dd></dl><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><dl class="item-table"><dt><a class="fn" href="fn.create_subspace_archiver.html" title="fn sc_consensus_subspace::archiver::create_subspace_archiver">create_<wbr>subspace_<wbr>archiver</a></dt><dd>Create an archiver task.</dd><dt><a class="fn" href="fn.decode_block.html" title="fn sc_consensus_subspace::archiver::decode_block">decode_<wbr>block</a></dt><dd>Symmetrical to <a href="fn.encode_block.html" title="fn sc_consensus_subspace::archiver::encode_block"><code>encode_block()</code></a>, used to decode previously encoded blocks</dd><dt><a class="fn" href="fn.encode_block.html" title="fn sc_consensus_subspace::archiver::encode_block">encode_<wbr>block</a></dt><dd>Encode block for archiving purposes.</dd><dt><a class="fn" href="fn.recreate_genesis_segment.html" title="fn sc_consensus_subspace::archiver::recreate_genesis_segment">recreate_<wbr>genesis_<wbr>segment</a></dt><dd>Derive genesis segment on demand, returns <code>Ok(None)</code> in case genesis block was already pruned</dd></dl></section></div></main></body></html>